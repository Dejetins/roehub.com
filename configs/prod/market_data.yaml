version: 1

market_data:
  markets:
    # 1) Binance Spot
    - market_id: 1
      exchange: binance
      market_type: spot
      market_code: binance:spot
      rest:
        base_url: "https://api.binance.com"
        timeout_s: 15.0
        retries: 5
        backoff: { base_s: 0.5, max_s: 15.0, jitter_s: 0.3 }
        limiter: { mode: autodetect, safety_factor: 0.7, max_concurrency: 3 }
      ws:
        url: "wss://stream.binance.com:9443/stream"
        ping_interval_s: 20.0
        pong_timeout_s: 10.0
        reconnect: { min_delay_s: 0.5, max_delay_s: 60.0, factor: 1.7, jitter_s: 0.3 }
        max_symbols_per_connection: 200

    # 2) Binance Futures (USD-M)
    - market_id: 2
      exchange: binance
      market_type: futures
      market_code: binance:futures
      rest:
        base_url: "https://fapi.binance.com"
        timeout_s: 15.0
        retries: 5
        backoff: { base_s: 0.5, max_s: 15.0, jitter_s: 0.3 }
        limiter: { mode: autodetect, safety_factor: 0.7, max_concurrency: 3 }
      ws:
        url: "wss://fstream.binance.com/stream"
        ping_interval_s: 20.0
        pong_timeout_s: 10.0
        reconnect: { min_delay_s: 0.5, max_delay_s: 60.0, factor: 1.7, jitter_s: 0.3 }
        max_symbols_per_connection: 200

    # 3) Bybit Spot (V5)
    - market_id: 3
      exchange: bybit
      market_type: spot
      market_code: bybit:spot
      rest:
        base_url: "https://api.bybit.com"
        timeout_s: 15.0
        retries: 5
        backoff: { base_s: 0.5, max_s: 15.0, jitter_s: 0.3 }
        limiter: { mode: autodetect, safety_factor: 0.7, max_concurrency: 3 }
      ws:
        url: "wss://stream.bybit.com/v5/public/spot"
        ping_interval_s: 20.0
        pong_timeout_s: 10.0
        reconnect: { min_delay_s: 0.5, max_delay_s: 60.0, factor: 1.7, jitter_s: 0.3 }
        max_symbols_per_connection: 10

    # 4) Bybit Futures (V5 linear)
    - market_id: 4
      exchange: bybit
      market_type: futures
      market_code: bybit:futures
      rest:
        base_url: "https://api.bybit.com"
        timeout_s: 15.0
        retries: 5
        backoff: { base_s: 0.5, max_s: 15.0, jitter_s: 0.3 }
        limiter: { mode: autodetect, safety_factor: 0.7, max_concurrency: 3 }
      ws:
        url: "wss://stream.bybit.com/v5/public/linear"
        ping_interval_s: 20.0
        pong_timeout_s: 10.0
        reconnect: { min_delay_s: 0.5, max_delay_s: 60.0, factor: 1.7, jitter_s: 0.3 }
        max_symbols_per_connection: 200

  ingestion:
    flush_interval_ms: 250
    max_buffer_rows: 3000
    rest_concurrency_instruments: 4
    tail_lookback_minutes: 180

  scheduler:
    jobs:
      sync_whitelist:
        interval_seconds: 3600
      enrich:
        interval_seconds: 43200
      rest_insurance_catchup:
        interval_seconds: 3600

  backfill:
    max_days_per_insert: 7
    chunk_align: "utc_day"
